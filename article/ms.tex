\documentclass[useAMS,usenatbib]{mn2e}

\usepackage{amsmath,amsbsy}

% Convenient colloquiualisms.
\newcommand\article{\textit Article}
\newcommand\tc{\textit{The Cannon} }

% Convenient maths.
\newcommand\K{$\mathbf{K}$}
\newcommand\lv{\mathbf{\boldsymbol\ell_n}}
\newcommand\cv{{\boldsymbol\theta}_\lambda}
\newcommand\given{|}

\title[Cannon Chemistry]{Detailed Chemical Abundances with \tc} 
% Some arrangement of the following authors:
\author[Casey et al.]{A.~R.~Casey$^1$, M.~Ness$^2$, G.~Gilmore$^1$,
    D.~W.~Hogg$^{2,3,4}$, H.~W.~Rix$^2$ \\ 
$^1$Institute of Astronomy, University of Cambridge, Madingley Road, Cambridge
    CB3 0HA, UK\\
$^2$Max-Planck-Institut f\"ur Astronomie, K\"onigstuhl 17, D-69117 Heidelberg,
    Germany\\
$^3$Center for Cosmology and Particle Physics, Department of Physics, New York
    University, 4 Washington Pl., room 424, New York, \\
    NY, 10003, USA\\
$^4$Center for Data Science, New York University, 726 Broadway, 7th Floor,
    New York, NY 10003, USA}
\begin{document}

\date{Accepted 2015 XX XX. Received 2015 October XX; in original form 2015 XX xx}

\pagerange{\pageref{firstpage}--\pageref{lastpage}} \pubyear{2015}

\maketitle

\label{firstpage}

\begin{abstract}
More than 15 million spectra are expected to be acquired by stellar surveys in
the coming decade. The detailed chemical abundance analysis of these data poses
a significant computational challenge. \tc provides a purely data-driven
approach to stellar parameter (label) determination. Cross-validation tests
demonstrate that the precision achievable is comparable to existing methods that
rely on model atmospheres and spectral synthesis, but \tc is $\sim$300,000 times
faster, making it perfectly apt for surveys. Simply extending the label vector
dimensionality of \tc to include individual abundances can create enormous
model difficulties, severely limiting the interpretability of the results. Here
we describe an alternative approach to including individual element abundances
in \tc. Using modest simplifications of the physics of spectral line formation,
we demonstrate precisely \textit{why} an approach like \tc works so effectively,
and provide a physically-motivated model that describes flux values, given the
stellar parameters. The inclusion of individual chemical abundances does not
impact on model flexibility, allowing for simultaneous training on detailed
chemical abundances, as well as arbitrary labels where the impact on the spectra
is unknown or poorly understood (e.g., mass, age). Crucially, we provide a link
between data-driven models and parallel works on model atmospheres and spectral
line formation, allowing for data to inform models. We demonstrate that
detailed chemical abundances can be measured with a precision of 0.0X-0.0Y~dex
in Z APOGEE spectra on a modern CPU in just one minute.
\end{abstract}

\begin{keywords}
\end{keywords}

\section{Introduction}

% it's awesome: fast, accurate and precise (given the models published thus far)
% impressively it does all this whilst ignoring all advances made in stellar physics over the past 100 years.

\section{Model}


\tc{} provides a purely data-driven approach to stellar label determination. The
spectral model describes the flux at every pixel $f_{n\lambda}$ to be a function
of a coefficient vector $\cv$, and a label vector $\lv$:

\begin{equation}
    f_{n\lambda} = g(\lv\given\cv) + {\rm noise}.
\end{equation}

This form is flexible: the label vector $\lv$ may be linear in just a few labels
or a complex combination of all $K$ available labels. The underlying principle
is that the flux for any pixel from any star is predictable with a very simple
model (generally a polynomial), given the labels. Indeed, \citet{Ness2015}
employ a quadratic-in-labels (see their Equation 8) spectral model using stellar
parameters (effective temperature $T_{\rm eff}$, surface gravity $\log{g}$, and 
metallicity [M/H]\footnote{\citet{Ness2015} use [Fe/H] in $\lv$, but for the 
sake of distinguishing between overall metallicity and individual abundances,
we opt for [M/H] to describe overall metallicity throughout this \article{}})
and demonstrate by cross-validation that these labels can be 
measured with a precision of 95~K in $T_{\rm eff}$, 0.24 in $\log{g}$, 0.08 in 
[M/H], with negligible biases. It is important to note that these uncertainties
are comparable to those reported from using \textit{curve-of-growth} on similar 
data sets (e.g., \citet{X,Y}).  


Utilising a simple polynomial model to predict spectral fluxes is a distinctive
method from parallel efforts in radiative transfer of realistic (3D) stellar 
photospheres. Calculations of this nature are extremely expensive. Indeed, even
with simplications of these models (e.g., interpolated 1D photospheres),
calculating integrated flux requires knowledge of species opacities, detailed 
atomic and molecular information for all contributing elements, solving for
the equation of state, and performing radiative transfer calculations. Given the
simplicity of \tc{} and a quadratic-in-labels spectral model, it is remarkable
that these complex calculations can be simplified so much, whilst maintaining
the typical fidelity reported for high-resolution spectroscopic studies.

Before extending this framework to include individual chemical abundances, it is
a useful exercise to understand \textit{why} a simple polynomial model can 
approximate spectral synthesis calculations with comparable fidelity. The reason
extends past model flexibility: one could imagine a similar coefficient vector
$\cv$ with a different functional form of the label vector $\lv$ (e.g., an
extreme case might be $\lv \equiv [1, {\rm [M/H]}^{T_{\rm eff}},
\log{g}^{T_{\rm eff}}]$) which would probably be incapable of describing
spectral fluxes with any fidelity.

% Describe the model of EW formation

% How this changes as a function of teff, logg, feh

% dealing with integrated EW.
% APOGEE is R ~ 20,000


% existing simple model. replaces expensive synthesis, involving model atmosphere
% generation, t-tau relations, opacities, equation of state, integrated line-of-sight
% and radiative transfer, etc.

% before extending this model to include individual abundances, it is worthwhile
% demonstrating (from a physics perspective) *why* the cannon works so well.

% APOGEE, R of 20,000, 
% LAMOST, higher Rs
% super high-resolution also works.


\section{Analysis}
% Detailed chemical abundances with APOGEE.



\section{Conclusions}


\section*{Acknowledgments}
This research was fostered by discussions at the \textit{New Milky Way}
conference hosted by the Munich Institute for Astro- and Particle Physics, and
the \textit{Stellar Streams in the Local Universe} conference hosted at Ringberg
Castle by the Max-Planck-Institut F\"ur Astronomie. This research made use of 
Astropy, a community-developed core Python package for Astronomy \citep{astropy}.

\begin{thebibliography}{99}
\bibitem[Astropy Collaboration et al.(2013)]{astropy} Astropy Collaboration, Robitaille, T.~P., Tollerud, E.~J., et al.\ 2013, \aap, 558, AA33

\bibitem[Ness et al.(2015)]{Ness2015} Ness, M., Hogg, D.~W., 
Rix, H.-W., Ho, A.~Y.~Q., \& Zasowski, G.\ 2015, \apj, 808, 16 
\end{thebibliography}


\label{lastpage}

\end{document}

